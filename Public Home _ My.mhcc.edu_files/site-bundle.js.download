function MM_swapImgRestore(){for(var n,i=document.MM_sr,t=0;i&&t<i.length&&(n=i[t])&&n.oSrc;t++)n.src?n.src=n.oSrc:n.background=n.oSrc}function MM_swapImage(){var t,r=0,n,i=MM_swapImage.arguments;for(document.MM_sr=[],t=0;t<i.length-2;t+=3)(n=MM_findObj(i[t]))!=null&&(document.MM_sr[r++]=n,n.src?(n.oSrc=n.src,n.src=i[t+2]):(n.oSrc=n.background,n.background=i[t+2]))}function MM_findObj(n,t){var u,r,i;for(t||(t=document),(u=n.indexOf("?"))>0&&parent.frames.length&&(t=parent.frames[n.substring(u+1)].document,n=n.substring(0,u)),(i=t[n])||!t.all||(i=t.all[n]),r=0;!i&&r<t.forms.length;r++)i=t.forms[r][n];for(r=0;!i&&t.layers&&r<t.layers.length;r++)i=MM_findObj(n,t.layers[r].document);return!i&&t.getElementById&&(i=t.getElementById(n)),i}function MM_dragLayer(objName,x,hL,hT,hW,hH,toFront,dropBack,cU,cD,cL,cR,targL,targT,tol,dropJS,et,dragJS){var i,j,aLayer,retVal,curDrag=null,curLeft,curTop,IE=document.all,NS4=document.layers,NS6=!IE&&document.getElementById,NS=NS4||NS6,spns,all,theEvent,aLayerZ,isVisible,parentL,parentT,tmpX,tmpY,tmpW,tmpH,mouseX,mouseY,positionField;if(!IE&&!NS)return!1;if(retVal=!0,IE&&event&&(event.returnValue=!0),MM_dragLayer.arguments.length>1){if(curDrag=MM_findObj(objName),!curDrag)return!1;if(!document.allLayers){document.allLayers=[];with(document)if(NS4){for(i=0;i<layers.length;i++)allLayers[i]=layers[i];for(i=0;i<allLayers.length;i++)if(allLayers[i].document&&allLayers[i].document.layers)with(allLayers[i].document)for(j=0;j<layers.length;j++)allLayers[allLayers.length]=layers[j]}else{if(NS6)for(spns=getElementsByTagName("span"),all=getElementsByTagName("div"),i=0;i<spns.length;i++)spns[i].style&&spns[i].style.position&&(allLayers[allLayers.length]=spns[i]);for(i=0;i<all.length;i++)all[i].style&&all[i].style.position&&(allLayers[allLayers.length]=all[i])}}curDrag.MM_dragOk=!0;curDrag.MM_targL=targL;curDrag.MM_targT=targT;curDrag.MM_tol=Math.pow(tol,2);curDrag.MM_hLeft=hL;curDrag.MM_hTop=hT;curDrag.MM_hWidth=hW;curDrag.MM_hHeight=hH;curDrag.MM_toFront=toFront;curDrag.MM_dropBack=dropBack;curDrag.MM_dropJS=dropJS;curDrag.MM_everyTime=et;curDrag.MM_dragJS=dragJS;curDrag.MM_oldZ=NS4?curDrag.zIndex:curDrag.style.zIndex;curLeft=NS4?curDrag.left:NS6?parseInt(curDrag.style.left):curDrag.style.pixelLeft;String(curLeft)=="NaN"&&(curLeft=0);curDrag.MM_startL=curLeft;curTop=NS4?curDrag.top:NS6?parseInt(curDrag.style.top):curDrag.style.pixelTop;String(curTop)=="NaN"&&(curTop=0);curDrag.MM_startT=curTop;curDrag.MM_bL=cL<0?null:curLeft-cL;curDrag.MM_bT=cU<0?null:curTop-cU;curDrag.MM_bR=cR<0?null:curLeft+cR;curDrag.MM_bB=cD<0?null:curTop+cD;curDrag.MM_LEFTRIGHT=0;curDrag.MM_UPDOWN=0;curDrag.MM_SNAPPED=!1;document.onmousedown=MM_dragLayer;document.onmouseup=MM_dragLayer;NS&&document.captureEvents(Event.MOUSEDOWN|Event.MOUSEUP)}else{if(theEvent=NS?objName.type:event.type,theEvent=="mousedown"){var mouseX=NS?objName.pageX:event.clientX+document.body.scrollLeft,mouseY=NS?objName.pageY:event.clientY+document.body.scrollTop,maxDragZ=null;for(document.MM_maxZ=0,i=0;i<document.allLayers.length;i++)if(aLayer=document.allLayers[i],aLayerZ=NS4?aLayer.zIndex:parseInt(aLayer.style.zIndex),aLayerZ>document.MM_maxZ&&(document.MM_maxZ=aLayerZ),isVisible=(NS4?aLayer.visibility:aLayer.style.visibility).indexOf("hid")==-1,aLayer.MM_dragOk!=null&&isVisible)with(aLayer){if(parentL=0,parentT=0,NS6)for(parentLayer=aLayer.parentNode;parentLayer!=null&&parentLayer.style.position;)parentL+=parseInt(parentLayer.offsetLeft),parentT+=parseInt(parentLayer.offsetTop),parentLayer=parentLayer.parentNode;else if(IE)for(parentLayer=aLayer.parentElement;parentLayer!=null&&parentLayer.style.position;)parentL+=parentLayer.offsetLeft,parentT+=parentLayer.offsetTop,parentLayer=parentLayer.parentElement;style.pixelLeft=offsetLeft;style.pixelTop=offsetTop;tmpX=mouseX-((NS4?pageX:(NS6?parseInt(style.left):style.pixelLeft)+parentL)+MM_hLeft);tmpY=mouseY-((NS4?pageY:(NS6?parseInt(style.top):style.pixelTop)+parentT)+MM_hTop);String(tmpX)=="NaN"&&(tmpX=0);String(tmpY)=="NaN"&&(tmpY=0);tmpW=MM_hWidth;tmpW<=0&&(tmpW+=NS4?clip.width:offsetWidth);tmpH=MM_hHeight;tmpH<=0&&(tmpH+=NS4?clip.height:offsetHeight);0<=tmpX&&tmpX<tmpW&&0<=tmpY&&tmpY<tmpH&&(maxDragZ==null||maxDragZ<=aLayerZ)&&(curDrag=aLayer,maxDragZ=aLayerZ)}curDrag&&(document.onmousemove=MM_dragLayer,NS4&&document.captureEvents(Event.MOUSEMOVE),curLeft=NS4?curDrag.left:NS6?parseInt(curDrag.style.left):curDrag.style.pixelLeft,curTop=NS4?curDrag.top:NS6?parseInt(curDrag.style.top):curDrag.style.pixelTop,String(curLeft)=="NaN"&&(curLeft=0),String(curTop)=="NaN"&&(curTop=0),MM_oldX=mouseX-curLeft,MM_oldY=mouseY-curTop,document.MM_curDrag=curDrag,curDrag.MM_SNAPPED=!1,curDrag.MM_toFront&&(eval("curDrag."+(NS4?"":"style.")+"zIndex=document.MM_maxZ+1"),curDrag.MM_dropBack||document.MM_maxZ++),retVal=!1,NS4||NS6||(event.returnValue=!1))}else if(theEvent=="mousemove"){if(document.MM_curDrag)with(document.MM_curDrag)mouseX=NS?objName.pageX:event.clientX+document.body.scrollLeft,mouseY=NS?objName.pageY:event.clientY+document.body.scrollTop,newLeft=mouseX-MM_oldX,newTop=mouseY-MM_oldY,MM_bL!=null&&(newLeft=Math.max(newLeft,MM_bL)),MM_bR!=null&&(newLeft=Math.min(newLeft,MM_bR)),MM_bT!=null&&(newTop=Math.max(newTop,MM_bT)),MM_bB!=null&&(newTop=Math.min(newTop,MM_bB)),MM_LEFTRIGHT=newLeft-MM_startL,MM_UPDOWN=newTop-MM_startT,NS4?(left=newLeft,top=newTop):NS6?(style.left=newLeft,style.top=newTop):(style.pixelLeft=newLeft,style.pixelTop=newTop),MM_dragJS&&eval(MM_dragJS),retVal=!1,NS||(event.returnValue=!1)}else if(theEvent=="mouseup"){if(document.onmousemove=null,NS&&document.releaseEvents(Event.MOUSEMOVE),NS&&document.captureEvents(Event.MOUSEDOWN),document.MM_curDrag)with(document.MM_curDrag)positionField=MM_findObj(id+"_PopupPosition"),positionField&&(positionField.value=style.pixelLeft+","+style.pixelTop),typeof MM_targL=="number"&&typeof MM_targT=="number"&&Math.pow(MM_targL-(NS4?left:NS6?parseInt(style.left):style.pixelLeft),2)+Math.pow(MM_targT-(NS4?top:NS6?parseInt(style.top):style.pixelTop),2)<=MM_tol&&(NS4?(left=MM_targL,top=MM_targT):NS6?(style.left=MM_targL,style.top=MM_targT):(style.pixelLeft=MM_targL,style.pixelTop=MM_targT),MM_SNAPPED=!0,MM_LEFTRIGHT=MM_startL-MM_targL,MM_UPDOWN=MM_startT-MM_targT),(MM_everyTime||MM_SNAPPED)&&eval(MM_dropJS),MM_dropBack&&(NS4?zIndex=MM_oldZ:style.zIndex=MM_oldZ),retVal=!1,NS||(event.returnValue=!1);document.MM_curDrag=null}NS&&document.routeEvent(objName)}return retVal}function MM_showHideLayers(){for(var n,t,r=MM_showHideLayers.arguments,u,i=0;i<r.length-2;i+=3)(t=MM_findObj(r[i]))!=null&&(n=r[i+2],u=MM_findObj(t.id+"_PopupState"),t.style&&(t=t.style,n=n=="show"?"visible":n=="hide"?"hidden":n,u&&(u.value=n)),t.visibility=n)}function preventDefaultEvent(n,t){if(n!=null&&typeof n.type=="string"&&(t===!1||t==null))if(n.preventDefault)n.preventDefault();else if("returnValue"in n)n.returnValue=!1;else throw new Error("The browser does not support known DOM Level II event cancellation.");return t}function AttachEvent(n,t,i){if(n.attachEvent)return t.substr(0,2).toLowerCase()!="on"&&(t="on"+t),n.attachEvent(t,i);n.addEventListener&&n.addEventListener(t,i,!1)}function DetachEvent(n,t,i){n.detachEvent?n.detachEvent("on"+t,i):n.removeEventListener&&n.removeEventListener(t,i,!1)}function checkDate(n,t,i){var r,s,u,f,o,e;(t!=!0||n.value!="")&&(r=!1,i.substring(0,2).toLowerCase()=="dd"&&(r=!0),s=r?/^([0]?[1-9]|[1|2][0-9]|[3][0|1])[/]([0]?[1-9]|[1][0-2])[/]([0-9]{4}|[0-9]{2})$/:/^([0]?[1-9]|[1][0-2])[/]([0]?[1-9]|[1|2][0-9]|[3][0|1])[/]([0-9]{4}|[0-9]{2})$/,s.test(n.value)?(r?(f=n.value.split("/")[0],u=n.value.split("/")[1]):(u=n.value.split("/")[0],f=n.value.split("/")[1]),o=n.value.split("/")[2],e=new Date(o,u-1,f),(e.getMonth()+1!=u||e.getDate()!=f||e.getFullYear()!=o)&&alert("Invalid Day, Month, or Year range detected. Please correct.")):(alert("Invalid Date Format. Please correct."),n.value=""))}function getQueryStringVariable(n){for(var i,u=window.location.search.substring(1),r=u.split("&"),t=0;t<r.length;t++)if(i=r[t].split("="),i[0]==n)return urldecode(i[1]);return null}function urldecode(n){return decodeURIComponent((n+"").replace(/\+/g,"%20"))}function start_portlet_view_life_cycle(portlet_view_unique_name,type_name){function detect_load(){div.offsetHeight===0?setTimeout(detect_load,0):portlet_view.load()}var portlet_view,div;if(!(window[portlet_view_unique_name]instanceof eval(type_name))){setTimeout(arguments.callee,0);return}portlet_view=window[portlet_view_unique_name];typeof portlet_view.init=="function"&&portlet_view.init();portlet_view.load instanceof Function&&(typeof portlet_view.get_div=="function"&&(div=portlet_view.get_div()),div!=null&&detect_load())}function pageLoad(){Sys.WebForms.PageRequestManager.getInstance().add_endRequest(EndRequestHandler)}function EndRequestHandler(n,t){if(t.get_error()){var i=new RegExp("Sys.*?: ","g");alert(t.get_error().message.replace(i,""));t.set_errorHandled(!0)}}function newId(){return"unq"+ ++unqId}function curId(){return"unq"+unqId}function nextElement(n){for(var t=n;t=t.nextSibling;)if(t.nodeType==1)return t;return null}function doLoad(){document.getElementById&&(initSideBar(),initToolbars(),initSecTable(),initPrincipalSelector(),initMoveCopyDelete(),initGridCheckAll());document.onclick=function(){for(var t=this.getElementsByTagName("iframe"),n=0;n<t.length;n++)t[n].parentNode.className=="date"&&t[n]!=keepThisCalendarOpen&&(t[n].style.visibility="hidden");keepThisCalendarOpen=null};document.resize=function(){initPrincipalSelector()}}function initFormDoublePostPrevention(){for(var t=!0,n=0;n<document.forms.length;n++)document.forms[n].onsubmit2=document.forms[n].onsubmit,document.forms[n].onsubmit=function(){return window.ValidatorCommonOnSubmit&&(t=ValidatorCommonOnSubmit()),t?this.hasBeenSubmitted?!1:(this.hasBeenSubmitted=!0,this.onsubmit2)?this.onsubmit2():!0:!1}}function initPrincipalSelector(){for(var n,r,u=document.getElementsByTagName("ul"),t=0;t<u.length;t++)if(u[t].className.indexOf("root")>-1)for(n=u[t].getElementsByTagName("li"),i=0;i<n.length;i++)n[i].getElementsByTagName("ul").length>0&&(r=document.createElement("a"),r.onclick=function(){this.parentNode.className=this.parentNode.className=="hasKids open"?"hasKids closed":"hasKids open"},r.className="tog",n[i].insertBefore(r,n[i].firstChild),n[i].className=n[i].getElementsByTagName("strong").length==0?"hasKids closed":"hasKids open")}function initSideBar(){var t=document.getElementById("quickLinks"),i,r,n;if(t){for(i=t.getElementsByTagName("dl"),n=0;n<i.length;n++)i[n].className="closed";for(r=t.getElementsByTagName("dt"),n=0;n<r.length;n++)r[n].onclick=function(){this.parentNode.className=this.parentNode.className=="open"?"closed":"open"}}}function initToolbars(){for(var r,u,t=document.getElementsByTagName("ul"),n=0;n<t.length;n++)if(t[n].className.indexOf("menu")>-1)for(r=t[n].getElementsByTagName("li"),i=0;i<r.length;i++)r[i].getElementsByTagName("ul").length>0&&(r[i].onmouseover=function(){this.getElementsByTagName("a")[0].className="hasKids active";var n=this.getElementsByTagName("ul");n.length>0&&(n[0].style.display="block",this.className="open")},r[i].onmouseout=function(){var t,n;for(this.getElementsByTagName("a")[0].className="hasKids",t=this.getElementsByTagName("ul"),n=0;n<t.length;n++)t[n].style.display="none";this.className=""},u=r[i].getElementsByTagName("a")[0],u.onclick=function(){return!1},u.className="hasKids");for(t=document.getElementsByTagName("div"),n=0;n<t.length;n++)t[n].className=="pTool"&&t[n].getElementsByTagName("ul").length>0&&(t[n].onmouseover=function(){this.getElementsByTagName("a")[0].className="hasKids active";this.getElementsByTagName("ul")[0].style.visibility="visible";typeof toggleHtmlSelectElements=="function"&&toggleHtmlSelectElements("hidden")},t[n].onmouseout=function(){this.getElementsByTagName("a")[0].className="hasKids";this.getElementsByTagName("ul")[0].style.visibility="hidden";typeof toggleHtmlSelectElements=="function"&&toggleHtmlSelectElements("visible")})}function initSecTable(){for(var r,t,u,i=document.getElementsByTagName("table"),n=0;n<i.length;n++)if(i[n].className=="secTable")for(r=i[n].getElementsByTagName("tbody")[0].getElementsByTagName("tr"),t=0;t<r.length;t++)u=r[t].getElementsByTagName("input")[0],u.parentNode.className=="admin"&&(u.onclick=function(){for(var t=this.parentNode.parentNode.getElementsByTagName("input"),n=1;n<t.length;n++)this.checked?(t[n].wasChecked=t[n].checked,t[n].checked=!0,t[n].disabled=!0):(t[n].checked=t[n].wasChecked,t[n].disabled=!1)})}function initMoveCopyDelete(){for(var t=document.getElementsByTagName("select"),n=0;n<t.length;n++)t[n].className=="mcdAction"&&(t[n].onchange=function(){var n=this.parentNode.getElementsByTagName("span");this.value=="d"||this.value=="s"?(n[1].style.display="none",n[2].style.display="inline"):(n[1].style.display="inline",n[2].style.display="none")})}function initGridCheckAll(){for(var t,n,r=document.getElementsByTagName("thead"),i=0;i<r.length;i++)for(t=r[i].getElementsByTagName("input"),n=0;n<t.length;n++)t[n].type!="checkbox"||t[n].onclick||(t[n].onclick=function(){for(var i=this,t,n;i=i.parentNode;)if(i.tagName=="TABLE")break;for(t=i.getElementsByTagName("input"),n=0;n<t.length;n++)t[n]!=this&&t[n].type=="checkbox"&&(t[n].checked=this.checked)})}function sectTog(n){return n.alt=="-"?shrink(n):grow(n),!1}function grow(n){n.alt="-";n.title=n.hideText;n.src=n.src.replace("expand.gif","collapse.gif");for(var i=n.parentNode.parentNode,t=i;t=t.nextSibling;){if(t.tagName&&t.tagName==i.tagName)return;t.style&&(t.style.display="")}}function shrink(n){n.alt="+";n.title=n.showText;n.src=n.src.replace("collapse.gif","expand.gif");for(var i=n.parentNode.parentNode,t=i;t=t.nextSibling;){if(t.tagName&&t.tagName==i.tagName)return;t.style&&(t.style.display="none")}}function multiFileToggleAll(n){var t=n.parentNode.parentNode.parentNode.parentNode.getElementsByTagName("input");for(i=1;i<t.length;i++)t[i].checked=n.checked}function multiFileToggleOne(n){var t=n.parentNode.parentNode.parentNode.parentNode.getElementsByTagName("input");for(t[0].checked=!0,i=1;i<t.length;i++)t[0].checked=t[0].checked&t[i].checked}function cal(n){for(var t=n;t.offsetParent!=null;)t=t.offsetParent;n.nextSibling.offsetWidth>t.offsetWidth-n.nextSibling.offsetLeft&&(n.nextSibling.style.top=n.nextSibling.offsetTop+n.offsetHeight+"px",n.nextSibling.style.left=t.offsetWidth-n.nextSibling.offsetWidth+"px");(n.nextSibling.style.visibility=n.nextSibling.style.visibility=="visible"?"hidden":"visible")=="visible"&&n.nextSibling.contentWindow.show_calendar(n.previousSibling);keepThisCalendarOpen=n.nextSibling}function gridTog(n){for(var t=n.parentNode.parentNode.parentNode.parentNode.parentNode;t=t.nextSibling;){if(t.className=="gfoot"||t.className=="ghead")break;t.style.display=="none"?(n.src=gridToggleImagePath+"collapse.gif",t.style.display="",n.alt=n.HideText):(n.src=gridToggleImagePath+"expand.gif",t.style.display="none",n.alt=n.ShowText)}}function gg_ExpCol(n){var t=nextElement(n.parentNode.parentNode);t&&t.className.indexOf("subItem")>-1&&(t.style.display=t.style.display=="none"?"":"none",n.src&&(n.src=t.style.display=="none"?"ui/common/images/plus.gif":"ui/common/images/minus.gif"))}function Collapse(n,t){var u=document.getElementById(n),r,i,f;if(u!=null)for(r=u.getElementsByTagName("a"),i=0;i<r.length;i++)f=new String(r[i].id),f.indexOf(t,0)>-1&&gg_ExpCol(r[i])}function hideEnd(n){var r=n.parentNode.parentNode.parentNode.nextSibling,t=r.getElementsByTagName("input");for(n.checked&&(t[0].checked=!0),i=0;i<t.length;i++)t[i].disabled=n.checked;for(t=r.getElementsByTagName("img"),i=0;i<t.length;i++)t[i].disabled=n.checked;for(t=r.getElementsByTagName("select"),i=0;i<t.length;i++)t[i].disabled=n.checked}function hideEndX(n){var t=document.getElementsByName(n.name);for(i=0;i<t.length;i++)if(t[i].id.indexOf("Later")>0){hideEnd(t[i]);return}}function hideStart(n){if(n.value=="endNow"){var r=n.parentNode.parentNode.parentNode.previousSibling,t=n.parentNode.parentNode.parentNode.previousSibling.getElementsByTagName("input");for(i=0;i<t.length;i++)t[i].disabled=n.checked;for(t=n.parentNode.parentNode.parentNode.previousSibling.getElementsByTagName("img"),i=0;i<t.length;i++)t[i].disabled=n.checked;for(t=n.parentNode.parentNode.parentNode.previousSibling.getElementsByTagName("select"),i=0;i<t.length;i++)t[i].disabled=n.checked}}function hideStartX(n){var t=document.getElementsByName(n.name);hideStart(t[1])}function showSelAct(n,t){$("."+n).hide();$("."+t).show()}function removeTextNodes(n){var t=[];for(i=0;i<n.length;i++)n[i].nodeType!=3&&(t[t.length]=n[i]);return t}function tabClick(n,t){var i=removeTextNodes(n.parentNode.parentNode.parentNode.childNodes);for(i[0].value=t-1,x=2;x<i.length;x++)i[x].style.display=x-1==t?"block":"none";for(i=removeTextNodes(i[1].childNodes),x=0;x<i.length;x++)i[x].className="";n.parentNode.className="selected"}function cp_toggle(n){var t=n.parentNode.nextSibling;return t.style.display=="block"?(n.title=n.ExpandText,n.src=cpToggleImagePath+"expand.gif",t.style.display="none"):(n.title=n.CollapseText,n.src=cpToggleImagePath+"collapse.gif",t.style.display="block"),!1}function ct_toggle(n){var i=n.parentNode.childNodes[0],t=n.parentNode.childNodes[1];return t.style.display=="inline"?(n.title=n.ExpandText,n.src=cpToggleImagePath+"expand.gif",t.style.display="none",i.style.display="inline"):(n.title=n.CollapseText,n.src=cpToggleImagePath+"collapse.gif",t.style.display="inline",i.style.display="none"),!1}function doCheck(n,t){for(var r=n.getElementsByTagName("input"),i=0;i<r.length;i++)r[i].type=="checkbox"&&(r[i].checked=t)}function secTog(n){var i="block",t=n.parentNode;for(n.src.indexOf("close")>-1?(n.src=n.src.replace("close","open"),i="none"):n.src=n.src.replace("open","close");t=t.nextSibling;)t.style.display=i}function checkNumeric(n,t){var i=n;return isNaN(n.value)?(alert(t),i.select(),i.focus(),!1):!0}function UpdateCheckBoxCount(n){n.checked==!0?cbCount++:cbCount--}function limitText(n,t){n.value.length<t?n.pref=n.value:n.value=new String(n.value).substr(0,t)}function validateMCDClick(n,t){var u,r,i;if(n.parentNode.getElementsByTagName("select")[0].value=="d"&&(u=document.getElementById(t),u))for(r=u.getElementsByTagName("input"),i=0;i<r.length;i++)if(r[i].type=="checkbox"&&r[i].checked)return confirm("Are you sure you want to delete the selected items?")?!0:!1;return!0}function orderListBox(n,t){var i=document.getElementById(n),r,u,f;i!=null&&i.selectedIndex>=0&&(r=i.selectedIndex+t,r>=0&&r<i.options.length&&(u=i.options[r].text,f=i.options[r].value,i.options[r].text=i.options[i.selectedIndex].text,i.options[r].value=i.options[i.selectedIndex].value,i.options[i.selectedIndex].text=u,i.options[i.selectedIndex].value=f,orderListBoxSetHidden(i,i.selectedIndex),orderListBoxSetHidden(i,r),i.selectedIndex=r))}function orderListBoxSetHidden(n,t){document.getElementById(n.id+"_text"+t).value=n.options[t].text;document.getElementById(n.id+"_value"+t).value=n.options[t].value}function PrincipalSelectorCheckboxSwitch(n,t){var f=document.getElementById(t),r=f.getElementsByTagName("input"),e=GetGuestTableCell(f),u=null,i;for(e!=null&&(u=e.childNodes[0]),i=0;i<r.length;i++)r[i].type=="checkbox"&&r[i].id!=n.id&&(u==null||u!=null&&r[i].id!=u.id)&&(r[i].checked=n.checked,r[i].disabled=n.checked)}function GetGuestTableCell(n){for(var i=n.getElementsByTagName("td"),t=0;t<i.length;t++)if(i[t].id=="GuestUserCell")return i[t];return null}function CheckLength(n,t,i){var r=document.getElementById(n),u;return r?(u=r.getHTML(),u.length<t?!0:(alert("You have exceeded the limit of "+t+" characters for the "+i),!1)):!0}function CheckLengthGeneric(n,t,i){var r=document.getElementById(n);return r.value.length<t?!0:(alert("You have exceeded the limit of "+t+" characters for the "+i),!1)}function ValidateLoginUserName(){var n=document.getElementById("userName").value;return n==""||n=="guest"?(alert("Please enter your User Name."),!1):!0}function ValidateDynamicRegEx_Save(n){ValidateDynamicRegEx_control=n.id;ValidateDynamicRegEx_savedText=n.value}function ValidateDynamicRegEx(n,t,i,r){if(n.value.length!=0&&!n.value.match(t)){if(i){for(var u=ValidateDynamicRegEx_control==n.id?ValidateDynamicRegEx_savedText:n.value;u.length>0&&!u.match(t);)u=u.substr(0,u.length-1);n.value=u}r!=null&&alert(r)}}function ValidateEmptyText(n,t,i){var r=document.getElementById(n);return i&&(r==null||r.value.length>0||r.value.match(/[^\s]/))||!i&&(r==null||r.value.length<1||!r.value.match(/[^\s]/))?(alert(t),!1):!0}function ToggleEmulationBtn(n,t){var i=document.getElementById(n),r=document.getElementById(t);i!=null&&r!=null&&(r.style.visibility=i.selectedIndex>0?"visible":"hidden")}function addLoadEvent(n){var t=window.onload;window.onload=typeof onload!="function"?n:function(){t&&t();n()}}function UpdateEditorTextArea(n){var t=document.getElementById(n);t.setHTML(t.getHTML())}function PopulateTextBoxEditor(n,t,i){if(n==null){alert("editorId field required in PopulateTextBox call.");return}var r=document.getElementById(n);if(r==null){alert("For PopulateTextBox call, unable to find TextBoxEditor with ID: "+n);return}t==null&&(t="");$("#"+n).val(t);typeof r.setHTML=="function"?((t==null||t=="")&&(t=" "),r.setHTML(t),i!=null&&i()):window.setTimeout("PopulateTextBoxEditor("+CreateStringParameter(n)+", "+CreateStringParameter(t)+", "+i+")",200)}function PopulateTextBoxEditorMce(n,t){t==null&&(t="");$("#"+n).val(t.replace(/\\/g,""))}function CreateStringParameter(n){return n==null?"null":"'"+n.replace(/'/g,"\\'").replace(/\n/g,"\\n").replace(/\r/g,"\\r")+"'"}function ResetEleVal(n,t){$("#"+n).val(t)}function ResetEleChecked(n,t){$("#"+n).prop("checked",t)}function EleRemoveClass(n){$("#"+n).removeClass()}function ApplyStyleToEle(n,t){$("#"+n).addClass(t)}function WriteMsgToEle(n,t){$("#"+n).text(t)}function ResetTxtVal(n,t){$("#"+n).text(t)}function ResetDatePicker(n,t,i,r){$("#"+n).val("");$("#"+t).val("11");$("#"+i).val("55");$("#"+r).val("AM")}function ToggleDivDisabled(n,t){t?$("#"+n+" :input").prop("disabled",!0):$("#"+n+" :input").prop("disabled",!1)}function HideShowEle(n,t){t?$("#"+n).show():$("#"+n).hide()}function ResetDatePickerPopulate(n,t,i,r,u,f,e,o){$("#"+n).val(u);$("#"+t).val(f);$("#"+i).val(e);$("#"+r).val(o)}function checkAllCheckboxes(n){var t=document.getElementsByTagName("input");for(i=0;i<t.length;i++)t[i].type=="checkbox"&&(t[i].checked=n)}function anyChecked(){var n=document.getElementsByTagName("input");for(i=0;i<n.length;i++)if(n[i].type=="checkbox"&&n[i].checked)return!0;return!1}function checkAllCheckboxesWithName(n,t){var r=document.getElementsByTagName("input");for(t==null&&(t=""),i=0;i<r.length;i++)r[i].type=="checkbox"&&r[i].name.indexOf(t)>=0&&(r[i].checked=n),r[i].type=="radio"&&r[i].name.indexOf(t)>=0&&(r[i].checked=n)}function anyCheckedWithName(n){var t=document.getElementsByTagName("input");for(n==null&&(n=""),i=0;i<t.length;i++)if(t[i].type=="checkbox"&&t[i].name.indexOf(n)>=0&&t[i].checked||t[i].type=="radio"&&t[i].name.indexOf(n)>=0&&t[i].checked)return!0;return!1}function checkAllCheckboxesWithID(n,t){var r=document.getElementsByTagName("input");for(t==null&&(t=""),i=0;i<r.length;i++)r[i].type=="checkbox"&&r[i].id!=null&&r[i].id.indexOf(t)>=0&&(r[i].checked=n),r[i].type=="radio"&&r[i].id!=null&&r[i].id.indexOf(t)>=0&&(r[i].checked=n)}function anyCheckedWithID(n){var t=document.getElementsByTagName("input");for(n==null&&(n=""),i=0;i<t.length;i++)if(t[i].type=="checkbox"&&t[i].id!=null&&t[i].id.indexOf(n)>=0&&t[i].checked||t[i].type=="radio"&&t[i].id!=null&&t[i].id.indexOf(n)>=0&&t[i].checked)return!0;return!1}function setControlsVisibilityWithNames(n,t,r,u){var f=document.getElementsByTagName(t);for(r==null&&(r=""),u==null&&(u=""),i=0;i<f.length;i++)f[i].id.indexOf(r)>=0&&f[i].id.indexOf(u)>=0&&f[i].getAttribute("Type")!="checkbox"&&(f[i].style.display=n?"block":"none",f[i].style.visibility=n?"visible":"hidden")}function setControlsVisibilityWithName(n,t,i){setControlsVisibilityWithNames(n,t,i,"")}function setControlsVisibilityInTheSameRow(n,t,i,r){var u=n.id,f;u&&(f=n.id.lastIndexOf("_"),u=u.substr(0,f+1),setControlsVisibilityWithNames(t,i,u,r))}function setControlsVisibilityInTheSameRow(n,t,i){var r=n.id,u;r&&(u=n.id.lastIndexOf("_"),r=r.substr(0,u+1),setControlsVisibilityWithName(t,i,r))}function checkADObjectName(n,t){return n.value.match(/[<>]+/)?(alert(t),n.select(),n.focus(),!1):!0}function moveSelectedInList(n,t,i){var f,e,r,u;if(t=t>0?1:-1,n.length!=-1){for(f=[],e=0,u=0;u<n.options.length;u++)opt=n.options[u],opt.selected&&(f[e]=u,e++);if(r=null,t<0&&f.reverse(),f.length==0&&i!=null&&i!=""){alert(i);return}for(u=0;u<f.length;u++)if(r=f[u],n.length!=0&&(r!=n.length-1||t!=-1)&&(r!=0||t!=1)){var o=n[r-t].text,s=n[r].text,h=n[r-t].value,c=n[r].value;n[r].text=o;n[r].value=h;n[r-t].text=s;n[r-t].value=c;n.options[r].selected=!1;n.options[r-t].selected=!0}}}function addLBItem(n,t,i,r){if(n!=null&&n.options!=null){var u=new Option(t,i,!1,r),f=n.options.length;n.options[f]=u}}function deleteLBItem(n,t){n!=null&&n.options!=null&&n.options.length!=0&&n.options.length>t&&(n.options[t]=null)}function SelectAllLBItems(n,t){if(n[t]!=null&&n[t].options!=null){var r=n[t].options.length;for(i=0;i<r;i++)n[t].options[i].selected=!0}}function moveSelItemsFromListboxes(n,t){var f,r,u;if(t==null&&(t=""),n!=null)for(f=n.name,r=document.getElementsByTagName("select"),i=0;i<r.length;i++)if(r[i].id!=null&&r[i].id!=n.id&&r[i].id.indexOf(t)>=0&&r[i].options!=null)for(u=0;u<r[i].options.length;u++)opt=r[i].options[u],opt.selected&&(addLBItem(n,opt.text,opt.value,!1),deleteLBItem(r[i],u),u--)}function ChangeElementClass(n,t){var i=document.getElementById(n);return typeof i!="undefined"&&(i.className=t),!0}function SearchNChangeElementClass(n,t,i,r){if(n==null||t==null||i==null)return!1;var u=n;return u=u.replace(t,i),ChangeElementClass(u,r),!0}function setTextBoxToZero(n,t){var r=document.getElementsByTagName("input");if(n){for(i=0;i<r.length;i++)if(r[i].id.indexOf("MIN"+t)>=0){r[i].value="0";r[i].readOnly="readOnly";return}}else for(i=0;i<r.length;i++)if(r[i].id.indexOf("MIN"+t)>=0){r[i].readOnly="";return}}function setTextBoxAttendance(n,t,r){var u=document.getElementsByTagName("input");for(i=0;i<u.length;i++)if(u[i].id.indexOf("MIN"+t)>=0){n?(u[i].value="0",u[i].readOnly="readOnly"):(u[i].value=r,u[i].readOnly="");return}}function doVis(n,t){if(n=document.getElementById(n),n!=null)switch(t){case 0:n.style.display="none";break;case 1:n.style.display="block"}}function doVis(n,t){if(n=document.getElementById(n),n!=null)switch(t){case 0:n.style.display="none";break;case 1:n.style.display="block"}}function processRequest(n){n.length>0&&(xmlHttp=GetXmlHttpObject(stateChangeHandler),xmlHttp.open("GET",n,!0),xmlHttp.send(null))}function isAJAXRequestProcessing(){return xmlHttp!=null&&xmlHttp.readyState!=4&&xmlHttp.readyState!="complete"}function stateChangeHandler(){if(xmlHttp.readyState==4||xmlHttp.readyState=="complete")switch(xmlHttp.status){case 200:xmlHttp.responseXML.documentElement!=null&&(sender=="TimecardApprovalSubmit"||(sender=="TimecardApproval"?PopulateTimecardDropdown(xmlHttp.responseXML.documentElement):(UpdateHostId(xmlHttp.responseXML.documentElement),RepopulateRoles(xmlHttp.responseXML.documentElement),RepopulateAvailableUsers(xmlHttp.responseXML.documentElement))));break;case 404:alert("Error code: "+xmlHttp.status+".  The requested URL could not be found.");break;case 500:var n=window.open("","errorWin");n.document.body.innerHTML=xmlHttp.responseText;break;default:alert("There was a problem retrieving data from the server. Error code: "+xmlHttp.status)}}function GetXmlHttpObject(n){var t=null;if(window.XMLHttpRequest)t=new XMLHttpRequest,t.onload=n,t.onerror=n,t.onreadystatechange=n;else if(window.ActiveXObject){try{t=new ActiveXObject("Msxml2.XMLHTTP")}catch(i){t=new ActiveXObject("Microsoft.XMLHTTP")}t.onreadystatechange=n}return t}function Push(n){arrayIndex==0&&(nameArr[arrayIndex]="");arrayIndex++;nameArr[arrayIndex]=n}function Pop(){arrayIndex--;return nameArr[arrayIndex]}function contextChange(n,t,i,r,u){for(var f,e,s,h,c,l,o,a,v;arrayIndex>0;)Pop();f=document.getElementById(i);f.value="";e=document.getElementById(t);e.value="";s=f.value+e.value;h=document.getElementById(r);h.checked=!0;c=document.getElementById(u);c.checked=!1;l=GetDN();o="lbAvailableUsers";ClearList(o);a=document.getElementById(o);v=new Option(n,n,!1,!1);a.options[0]=v;ChangeControlState(0);myRequestURL=".."+requestURL+"context";myRequestURL+="&dn="+l;myRequestURL+="&lastuser=";myRequestURL+="&searchtext="+s;myRequestURL+="&sender=US";processRequest(myRequestURL)}function searchChange(n,t){for(var r,e,o;arrayIndex>0;)Pop();var u=document.getElementById("txtUserLastName"),f=document.getElementById("txtUserFirstName"),i=document.getElementById("ddlRoles"),s=u.value.length+f.value.length;(s==1||t==i)&&(r="lbAvailableUsers",ClearList(r),e=document.getElementById(r),o=new Option(n,n,!1,!1),e.options[0]=o,ChangeControlState(0));var h=u.value+","+f.value,c=i.options[i.selectedIndex].value,l=GetDN();myRequestURL=".."+requestURL+"data";myRequestURL+="&dn="+l;myRequestURL+="&lastuser=";myRequestURL+="&searchtext="+h;myRequestURL+="&role="+c;myRequestURL+="&sender=US";processRequest(myRequestURL)}function selectedUserChange(n){var i=-1,t,r;if(n!=null){for(t=0;t<n.options.length;t++)if(n.options[t].selected){i=t;break}r=GetDN();i>-1&&(myRequestURL=".."+requestURL+"hostid",myRequestURL+="&dn="+n.options[i].value,myRequestURL+="&lastuser=",myRequestURL+="&searchtext="+r,myRequestURL+="&role=",myRequestURL+="&sender=US",processRequest(myRequestURL))}}function resetForm(n){var u=document.getElementById("txtUserLastName"),t,i,r;u.value="";t=document.getElementById("txtUserFirstName");t.value="";i=document.getElementById("ddlRoles");i.selectedIndex=0;r=document.getElementById("lbAvailableUsers");r.selectedIndex=-1;searchChange(n,this)}function nextPage(n){var s=document.getElementById("lnkbtnMore"),h=s.getAttribute("enabled"),t,f,o;if(h=="True"){var i=document.getElementById("lbAvailableUsers"),c=i.options.length,r=i.options[c-1].text;Push(r);var l=document.getElementById("txtUserLastName"),a=document.getElementById("txtUserFirstName"),v=l.value+","+a.value,u="lbAvailableUsers";ClearList(u);t=document.getElementById(u);f=new Option(n,n,!1,!1);t.options[0]=f;t.options[0].selected=!0;ChangeControlState(0);var e=document.getElementById("ddlRoles"),y=e.options[e.selectedIndex].value,p=GetDN();myRequestURL=".."+requestURL+"data";myRequestURL+="&dn="+p;myRequestURL+="&lastuser="+r;myRequestURL+="&searchtext="+v;myRequestURL+="&role="+y;myRequestURL+="&sender=US";myRequestURL+="&";o=new Date;myRequestURL+=o.getMilliseconds();processRequest(myRequestURL)}}function previousPage(n){var e=document.getElementById("lnkbtnPrevious"),o=e.getAttribute("enabled"),t,r,f;if(o=="True"){var y=document.getElementById("lbAvailableUsers"),s=Pop(),h=document.getElementById("txtUserLastName"),c=document.getElementById("txtUserFirstName"),l=h.value+","+c.value,i="lbAvailableUsers";ClearList(i);t=document.getElementById(i);r=new Option(n,n,!1,!1);t.options[0]=r;t.options[0].selected=!0;ChangeControlState(0);var u=document.getElementById("ddlRoles"),a=u.options[u.selectedIndex].value,v=GetDN();myRequestURL=".."+requestURL+"data";myRequestURL+="&dn="+v;myRequestURL+="&lastuser="+s;myRequestURL+="&searchtext="+l;myRequestURL+="&role="+a;myRequestURL+="&sender=US";myRequestURL+="&";f=new Date;myRequestURL+=f.getMilliseconds();processRequest(myRequestURL)}}function PostData(n){for(var u,f,r=document.getElementById("lbSelectedUsers"),t="",i=0;i<r.options.length;i++)r.options[i]!=null&&(u=encodeURI(r.options[i].text),f=encodeURI(r.options[i].value),t+="<user><displayname>"+u+"<\/displayname>",t+="<dn>"+f+"<\/dn><\/user>");return xmlHttp=GetXmlHttpObject(stateChangeHandler),xmlHttp.open("POST",n,!1),xmlHttp.setRequestHeader("Content-Type","text/xml"),t="<?xml version='1.0' encoding='UTF-8' ?><root>"+t+"<\/root>",xmlHttp.send(t),!0}function RepopulateAvailableUsers(n){var r="lbAvailableUsers",t=n.getElementsByTagName("user"),u,f,e,o,i,s;if(t!=null)if(t.length>0){for(ClearList(r),o=document.getElementById(r),i=0;i<t.length;i++)u=t[i].getAttribute("name"),f=t[i].getAttribute("value"),e=new Option(u,f,!1,!1),o.options[i]=e;ChangeControlState(t.length)}else s=n.getElementsByTagName("hostid")[0].firstChild,s==null&&(ClearList(r),ChangeControlState(0));else ClearList(r),ChangeControlState(0)}function RepopulateRoles(n){var r="ddlRoles",t=n.getElementsByTagName("role"),u,f,e,o,i;if(t!=null&&t.length>0){for(ClearList(r),o=document.getElementById(r),i=0;i<t.length;i++)u=t[i].getAttribute("name"),f=t[i].getAttribute("value"),e=new Option(u,f,!1,!1),o.options[i]=e;ChangeControlState(t.length)}}function UpdateHostId(n){var t=document.getElementById("nameSpan"),i=n.getElementsByTagName("username")[0].firstChild,r,u,f;i!=null?(i=i.nodeValue,t.innerHTML="&nbsp;&nbsp;<B>"+i+"<\/B>",r=n.getElementsByTagName("hostid")[0].firstChild.nodeValue,t.innerHTML+="&nbsp;&nbsp;"+r+"",u=n.getElementsByTagName("userroles")[0].firstChild.nodeValue,t.innerHTML+="<BR>&nbsp;&nbsp;"+u+""):(f=document.getElementById("selectusertext"),t.innerHTML=f.value)}function ChangeControlState(n){n<MAX_USERS_SHOWN?DisableControl("lnkbtnMore"):EnableControl("lnkbtnMore");arrayIndex<=0?DisableControl("lnkbtnPrevious"):EnableControl("lnkbtnPrevious");changeButtonState("btnAdd","lbAvailableUsers");changeButtonState("btnRemove","lbSelectedUsers")}function EnableControl(n){var t=document.getElementById(n);t.setAttribute("enabled","True");t.style.cursor="pointer";t.style.color="blue"}function DisableControl(n){var t=document.getElementById(n);t.setAttribute("enabled","False");t.style.cursor="default";t.style.color="gray"}function changeButtonState(n,t){var i=!1,e,u,f,r,o;if(arguments.length>2&&(e=document.getElementById(arguments[2]),arguments[3]!=null&&arguments[3]>0&&e.length>=arguments[3]&&(i=!0)),!i){for(u=!1,f=document.getElementById(t),r=0;r<f.options.length;r++)if(f.options[r].selected){u=!0;break}u||(i=!0)}o=document.getElementById(n);o.disabled=i}function GetDN(){var n,r=document.getElementById("allUsers"),t,i;return r!=null?r.checked?(i=document.getElementById("rootDN"),n=i.value):(t=document.getElementById("contextDN"),n=t.value):(t=document.getElementById("contextDN"),t!=null?n=t.value:(i=document.getElementById("rootDN"),n=i.value)),n}function addSelected(n){var s=document.getElementById("btnAdd"),r,t,i,f,e,o,u;if(!s.disabled){for(r=document.getElementById("lbAvailableUsers"),t=document.getElementById("lbSelectedUsers"),i=0;i<r.options.length;i++)if(r.options[i].selected){for(f=r.options[i].text,e=r.options[i].value,optionItem=new Option(f,e,!1,!1),o=!1,u=0;u<t.options.length;u++)if(t.options[u].text==f&&t.options[u].value==e){o=!0;break}o||(t.options[t.length]=optionItem)}changeButtonState("btnAdd","lbAvailableUsers","lbSelectedUsers",n)}}function removeSelected(){var f=document.getElementById("btnRemove"),n;if(!f.disabled){var i=[],t=0,r=document.getElementById("lbSelectedUsers"),u=document.getElementById("lbAvailableUsers");for(n=0;n<r.options.length;n++)r.options[n].selected&&(i[t]=n,t++);for(n=0;n<u.options.length;n++)u.options[n].selected&&(u.options[n].selected=!1);for(t=i.length-1;t>=0;t--)r.options[i[t]]=null;changeButtonState("btnRemove","lbSelectedUsers")}}function showDHTMLAlert(n,t,i,r){messageBoxMask==null&&messageBoxContainer==null&&initMessageBox(n,t,i,r);messageBoxIsShown=!0;messageBoxMask.style.display="block";messageBoxContainer.style.display="block";disableTabIndexes();hideSelectBoxes();centerMessageBox();setMaskSize()}function hideDHTMLAlert(){messageBoxIsShown=!1;var n=document.getElementsByTagName("BODY")[0];(n.style.overflow="",ActiveTabIndexes(),displaySelectBoxes(),RefreshSession(),messageBoxMask!=null&&messageBoxContainer!=null)&&(messageBoxMask.style.display="none",messageBoxContainer.style.display="none",window.onscroll=oldOnScroll)}function initMessageBox(n,t,r,u){body=document.getElementsByTagName("BODY")[0];mBoxmask=document.createElement("div");mBoxmask.id="messageBoxMask";mBoxcont=document.createElement("div");mBoxcont.id="messageBoxContainer";var f="";if(r!=null&&u!=null&&r.length==u.length)for(i=0;i<r.length;i++)f+='<input type="submit" id="button'+i+'" onclick="'+u[i]+'" value="'+r[i]+'" style="margin: 0px 15px;"/>';f!=""&&(f='<tr><td id="messageBoxMainControls" colspan="2">'+f+"<\/td><\/tr>");mBoxcont.innerHTML='<table id="messageBoxInner"><tr id="messageBoxTitleBar"><td id="messageBoxTitle">'+n+'<\/td><td id="messageBoxTitleControls"><img id="closebutton" src="UI/Common/Images/closebutton.gif" onclick="hideDHTMLAlert();" /><\/td><\/tr><tr><td id="messageBoxText" colspan="2">'+t+"<\/td><\/tr>"+f+"<\/table>";body.appendChild(mBoxmask);body.appendChild(mBoxcont);messageBoxMask=document.getElementById("messageBoxMask");messageBoxContainer=document.getElementById("messageBoxContainer");document.all||(document.onkeypress=keyDownHandler);window.addEventListener?(window.addEventListener("resize",centerMessageBox,!1),window.addEventListener("scroll",centerMessageBox,!1)):window.attachEvent&&(window.attachEvent("onresize",centerMessageBox),window.attachEvent("onscroll",centerMessageBox));oldOnScroll=window.onscroll;window.onscroll=centerMessageBox}function setMaskSize(){var n=document.getElementsByTagName("BODY")[0],t=getWinHeight(),i=getWinWidth();mBoxHeight=t>n.scrollHeight?t:n.scrollHeight;mBoxWidth=i>n.scrollWidth?i:n.scrollWidth;messageBoxMask.style.height=mBoxHeight+"px";messageBoxMask.style.width=mBoxWidth+"px"}function centerMessageBox(){if(messageBoxIsShown==!0){var n=messageBoxContainer.offsetWidth,t=messageBoxContainer.offsetHeight,i=parseInt(getScrollTop(),10),r=parseInt(getScrollLeft(),10),u=parseInt(document.getElementById("messageBoxTitleBar").offsetHeight,10),f=getWinHeight(),e=getWinWidth();setMaskSize();messageBoxContainer.style.top=i+(f-(t+u))/2+"px";messageBoxContainer.style.left=r+(e-n)/2+"px"}}function hideAndKeepSession(n){n?hideDHTMLAlert():DropSession()}function keyDownHandler(n){if(messageBoxIsShown&&n.keyCode==9)return!1}function disableTabIndexes(){var r,t,i,n;if(document.all)for(r=0,t=0;t<activeableTags.length;t++)for(i=document.getElementsByTagName(activeableTags[t]),n=0;n<i.length;n++)tabIndexes[r]=i[n].tabIndex,i[n].tabIndex="-1",r++}function ActiveTabIndexes(){var r,t,i,n;if(document.all)for(r=0,t=0;t<activeableTags.length;t++)for(i=document.getElementsByTagName(activeableTags[t]),n=0;n<i.length;n++)i[n].tabIndex=tabIndexes[r],i[n].tabEnabled=!0,r++}function hideSelectBoxes(){function r(){switch(navigator.appName){case"Microsoft Internet Explorer":return"ie";case"Netscape":return"netscape";default:return"other"}}for(var i,t,n=0;n<document.forms.length;n++)for(i=0;i<document.forms[n].length;i++)document.forms[n].elements[i].tagName=="SELECT"&&(document.forms[n].elements[i].style.visibility="hidden");for(t=document.getElementsByTagName("IFRAME"),n=0;n<t.length;n++)switch(r()){case"ie":try{t[n].contentWindow.document}catch(u){t[n].style.visibility="hidden"}break;case"netscape":t[n].contentDocument.location.href.toLowerCase().indexOf(".pdf")!=-1&&(t[n].style.visibility="hidden")}}function displaySelectBoxes(){for(var t,i,n=0;n<document.forms.length;n++)for(t=0;t<document.forms[n].length;t++)document.forms[n].elements[t].tagName=="SELECT"&&(document.forms[n].elements[t].style.visibility="visible");for(i=document.getElementsByTagName("IFRAME"),n=0;n<i.length;n++)i[n].style.visibility="visible"}function getWinHeight(){return window.innerHeight!=window.undefined?window.innerHeight:document.compatMode=="CSS1Compat"?document.documentElement.clientHeight:document.body?document.body.clientHeight:window.undefined}function getWinWidth(){return window.innerWidth!=window.undefined?window.innerWidth:document.compatMode=="CSS1Compat"?document.documentElement.clientWidth:document.body?document.body.clientWidth:void 0}function getScrollTop(){return self.pageYOffset?self.pageYOffset:document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:document.body?document.body.scrollTop:void 0}function getScrollLeft(){return self.pageXOffset?self.pageXOffset:document.documentElement&&document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body?document.body.scrollLeft:void 0}function DropSession(){if(messageBoxIsShown){var n=/^\/([A-Za-z0-9]+)[\/]?/.exec(location.pathname);window.location=n[0]+"?tool=droppedSession"}}function RefreshSession(){processRequest("AJAX/AJAXserver.aspx?action=keepSession")}function GetPayPeriods(n,t,i){ctrlToUpdate=t;sender="TimecardApproval";var r=document.getElementById(n);r.options[r.selectedIndex].value!=""&&(myRequestURL=i+requestURL+"payperiod",myRequestURL+="&paygroup="+r.options[r.selectedIndex].value,myRequestURL+="&sender=PTA",myRequestURL+="&noCache="+(new Date).getTime()+Math.random(),processRequest(myRequestURL))}function GetEmployees(n,t,i,r){ctrlToUpdate=i;sender="TimecardApproval";var u=document.getElementById(n),f=document.getElementById(t);u.options[u.selectedIndex].value!=""&&f.options[f.selectedIndex].value!=""&&(myRequestURL=r+requestURL+"employees",myRequestURL+="&paygroup="+u.options[u.selectedIndex].value,myRequestURL+="&payperiod="+f.options[f.selectedIndex].value,myRequestURL+="&sender=PTA",myRequestURL+="&noCache="+(new Date).getTime()+Math.random(),processRequest(myRequestURL))}function PopulateTimecardDropdown(n){var r=document.getElementById(ctrlToUpdate),i=n.getElementsByTagName("item"),u,f,e,t;if(i!=null&&i.length>0)for(ClearList(ctrlToUpdate),t=0;t<i.length;t++)u=i[t].getAttribute("text"),f=i[t].getAttribute("value"),e=new Option(u,f,!1,!1),r.options[t]=e;r.onupdated&&r.onupdated()}function ClearList(n){for(var i=document.getElementById(n),t=i.options.length-1;t>-1;t--)i.options[t]=null}var JSON,ValidateDynamicRegEx_control,ValidateDynamicRegEx_savedText;JSON||(JSON={}),function(){function i(n){return n<10?"0"+n:n}function o(n){return e.lastIndex=0,e.test(n)?'"'+n.replace(e,function(n){var t=s[n];return typeof t=="string"?t:"\\u"+("0000"+n.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+n+'"'}function u(i,f){var s,l,h,a,v=n,c,e=f[i];e&&typeof e=="object"&&typeof e.toJSON=="function"&&(e=e.toJSON(i));typeof t=="function"&&(e=t.call(f,i,e));switch(typeof e){case"string":return o(e);case"number":return isFinite(e)?String(e):"null";case"boolean":case"null":return String(e);case"object":if(!e)return"null";if(n+=r,c=[],Object.prototype.toString.apply(e)==="[object Array]"){for(a=e.length,s=0;s<a;s+=1)c[s]=u(s,e)||"null";return h=c.length===0?"[]":n?"[\n"+n+c.join(",\n"+n)+"\n"+v+"]":"["+c.join(",")+"]",n=v,h}if(t&&typeof t=="object")for(a=t.length,s=0;s<a;s+=1)typeof t[s]=="string"&&(l=t[s],h=u(l,e),h&&c.push(o(l)+(n?": ":":")+h));else for(l in e)Object.prototype.hasOwnProperty.call(e,l)&&(h=u(l,e),h&&c.push(o(l)+(n?": ":":")+h));return h=c.length===0?"{}":n?"{\n"+n+c.join(",\n"+n)+"\n"+v+"}":"{"+c.join(",")+"}",n=v,h}}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+i(this.getUTCMonth()+1)+"-"+i(this.getUTCDate())+"T"+i(this.getUTCHours())+":"+i(this.getUTCMinutes())+":"+i(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var f=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,n,r,s={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},t;typeof JSON.stringify!="function"&&(JSON.stringify=function(i,f,e){var o;if(n="",r="",typeof e=="number")for(o=0;o<e;o+=1)r+=" ";else typeof e=="string"&&(r=e);if(t=f,f&&typeof f!="function"&&(typeof f!="object"||typeof f.length!="number"))throw new Error("JSON.stringify");return u("",{"":i})});typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(n,t){var r,u,i=n[t];if(i&&typeof i=="object")for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(u=walk(i,r),u!==undefined?i[r]=u:delete i[r]);return reviver.call(n,t,i)}var j;if(text=String(text),f.lastIndex=0,f.test(text)&&(text=text.replace(f,function(n){return"\\u"+("0000"+n.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse");})}();var unqId=0,keepThisCalendarOpen,cbCount=0,inpReloadName="";ValidateDynamicRegEx_control=null;ValidateDynamicRegEx_savedText=null;String.format=function(){var t,n,i;if(arguments.length==0)return null;for(t=arguments[0],n=1;n<arguments.length;n++)i=new RegExp("\\{"+(n-1)+"\\}","gm"),t=t.replace(i,arguments[n]);return t};var xmlHttp,requestURL="/AJAX/AJAXserver.aspx?action=",nameArr=[],arrayIndex=0,MAX_USERS_SHOWN=100,sender="",ctrlToUpdate="";var messageBoxMask=null,messageBoxContainer=null,messageBoxIsShown=!1,tabIndexes=[],activeableTags=["A","BUTTON","TEXTAREA","INPUT","IFRAME"],oldOnScroll=null;window.jenzabar=window.jenzabar||{};jenzabar.framework=jenzabar.framework||{};window.stringUtil={};jenzabar.framework.stringUtil=window.stringUtil,function(n){"use strict";n.format=function(n){for(var r,t=0,i=arguments.length-1;t<i;t+=1)r=new RegExp("\\{"+t+"\\}","gm"),n=n.replace(r,arguments[t+1]);return n};n.splitFormat=function(n){if(!n)return[];var t=new RegExp("\\{[0-9]+?\\}","gm");return n.split(t)}}(jenzabar.framework.stringUtil);window.urlUtil={};jenzabar.framework.urlUtil=window.urlUtil,function(n){"use strict";n.getAppRoot=function(){var n=location.pathname.split("/");return n.length>1?"/"+n[1]+"/":"/ICS/"}}(jenzabar.framework.urlUtil);window.portalSettings={};jenzabar.framework.portalSettings=window.portalSettings,function(n){"use strict";n.webApiRootUrl=jenzabar.framework.urlUtil.getAppRoot()+"api/";n.rpcRootUrl=jenzabar.framework.urlUtil.getAppRoot()+"rpc/";n.globalizerWebServiceUrl=n.webApiRootUrl+"globalization/";n.portletSettingsWebServiceUrl=n.webApiRootUrl+"portletSettings/"}(jenzabar.framework.portalSettings);window.ajaxUtil={};jenzabar.framework.ajaxUtil=window.ajaxUtil,function(n,t){"use strict";n.callAsmxWebService=function(n,i,r,u){t.ajax({type:"POST",url:n,contentType:"application/json; charset=utf-8",data:JSON.stringify(i),dataType:"json",success:r,error:u})};n.callSynchronousAsmxWebService=function(n,i,r,u){t.ajax({type:"POST",url:n,async:!1,contentType:"application/json; charset=utf-8",data:JSON.stringify(i),dataType:"json",success:r,error:u})}}(jenzabar.framework.ajaxUtil,jQuery);jenzabar.framework.timeoutWarning={},function(n,t){"use strict";function f(){clearTimeout(u);jenzabar.framework.ajaxUtil.callAsmxWebService("services/sessionkeepalive.asmx/Ping");setTimeout(i,65e3)}function e(){jenzabar.framework.ajaxUtil.callAsmxWebService("services/sessionkeepalive.asmx/Logout",undefined,function(){window.location=jenzabar.framework.urlUtil.getAppRoot()})}var r,i,u;n.warningModal='<div id="twModal" title="{0}"><\/div>';n.glob={};n.defaultSettings={globUrl:jenzabar.framework.urlUtil.getAppRoot()+"api/globalization/timeoutwarning",sessionExpiresUrl:jenzabar.framework.urlUtil.getAppRoot()+".sessionheartbeat",timeoutWarningTime:6e4};r=function(r){if(r==="refresh"){f();return}var o=parseFloat(r);o<n.defaultSettings.timeoutWarningTime?(t("#twModal").html(n.glob.inactiveAlert).dialog("open").dialog("moveToTop"),u=setTimeout(e,o)):setTimeout(i,6e4)};i=function(){t.ajax({url:n.defaultSettings.sessionExpiresUrl}).done(r)};n.create=function(){t.ajax({url:n.defaultSettings.globUrl}).then(function(r){n.glob=r;t("body").append(jenzabar.framework.stringUtil.format(n.warningModal,n.glob.stillThere));var u={};u[n.glob.stayLoggedIn]=function(){f();t(this).dialog("close")};u[n.glob.logoutNow]=function(){location.href=t("#logout").attr("href")};t("#twModal").dialog({autoOpen:!1,modal:!0,width:500,buttons:u});setTimeout(i,65e3)})}}(jenzabar.framework.timeoutWarning,jQuery);jenzabar.framework.fileChooser={},function(n,t){"use strict";function i(n){n.isFile||(n.url=null)}n.create=function(n,r){var e=550,u=Math.random().toString().substring(2),f;return n.prev().hasClass("file-chooser")?n.prev().find(".choose-file"):(r||(r={}),f=t('<div id="fileChooser-'+u+'" class="file-chooser">\t<button type="button" id="fileChooser-button-'+u+'" class="choose-file">Choose File<\/button>\t<span id="fileChooser-fileName-'+u+'" class="chosen-file-name"><\/span><\/div>').insertBefore(n),f.find(".choose-file").click(function(u){var f=t(window).height()<=e;moxman.browse({fields:n.attr("id"),multiple:r.allowMultipleFiles?!0:!1,fullscreen:f,insert_filter:r.allowFolders?null:i});u.preventDefault()}),n.hide().change(function(){var n,i;n=t(this).val();i=decodeURIComponent(n.substr(n.lastIndexOf("/")+1));f.find(".chosen-file-name").text(i)}),n.prev().find(".choose-file"))}}(jenzabar.framework.fileChooser,jQuery),function(n){"use strict";n.fn.inlineLoading=function(t){function s(){e||(r.after(i).hide(),f=!0)}var r=n(this),u=t||{},i=n('<span class="inlineAsyncLoading"><\/span>'),o="MSG_INLINE_ASYNC_LOADING",f=!1,e=!0;return this.start=function(){if(e=!1,r.prop("disabled",!0),u.messageText)i.html(u.messageText);else{var t=u.messageKey||o;n.ajax({url:urlUtil.getAppRoot()+"api/globalization?id="+t,success:function(n){i.html(n[t.toLowerCase()])}})}setTimeout(s,200)},this.stop=function(){f&&i.remove();r.show().prop("disabled",!1);f=!1;e=!0},this}}(jQuery);jenzabar.framework.isFirefox=function(){return typeof InstallTrigger!="undefined"};jenzabar.framework.emberFirefoxFormFix=function(){var n=jenzabar.framework.isFirefox();n&&(__doPostBack=function(n,t){theForm.onsubmit&&theForm.onsubmit()==!1||(theForm.__EVENTTARGET.value=n,theForm.__EVENTARGUMENT.value=t,$("<button>",{type:"submit"}).appendTo("form").click())})};String.prototype.endsWith=function(n){return this.indexOf(n,this.length-n.length)!==-1},function(n,t){"use strict";function i(){var i={Terms:t("#"+n.textBox).val(),UserId:n.userId,MaxNumberOfResults:10};return JSON.stringify(i)}function r(){var n=i();return"api/autocomplete?request="+n}function u(n,i){i(t.map(n.results,function(n){return{label:n,value:n}}))}function f(){t(".advancedSearchLink").click(e)}function e(){t(this).prev(".advancedSearchContent").slideToggle(200);var i=t("#"+n.showHideLabel).text();t("#"+n.showHideLabel).text(i==="Show"?"Hide":"Show");i==="Show"?t(".advancedSearchLink").css("background","url(UI/Common/images/PortletImages/Icons/wedge-up.gif) center left no-repeat"):t(".advancedSearchLink").css("background","url(UI/Common/images/PortletImages/Icons/wedge-down.gif) center left no-repeat")}function o(){var i=0,c=document.getElementById(n.includePastCheckBox),o=getQueryStringVariable("query"),s=n.showInSideBar,u=!1,f=getQueryStringVariable("where"),h=getQueryStringVariable("includePastFutureCourses"),e=getQueryStringVariable("what"),r=document.getElementById(n.whatDropDown);if(o!==null?(document.getElementById(n.textBox).value=o,document.getElementById(n.textBox).style.color="#000000"):document.getElementById(n.textBox).value==="Search..."&&(document.getElementById(n.textBox).style.color="#808080"),s==="True"||s==="true"){if(f!==null){for(i=0;i<r.options.length;i++)if(r.options[i].value===f){r.selectedIndex=i;break}f!=="Everywhere"&&(u=!0)}if(e!==null){for(r=document.getElementById(n.whatDropDown),i=0;i<r.options.length;i++)if(r.options[i].value===e){r.selectedIndex=i;break}e!=="Everything"&&(u=!0)}h!==null&&(c.checked=!0,h==="true"&&(u=!0));u!==!0?(t(".advancedSearchContent").hide(),t(".advancedSearchLink").css("background","url(UI/Common/images/PortletImages/Icons/wedge-down.gif) center left no-repeat"),t(n.showHideLabel).text("Show")):(t(".advancedSearchLink").css("background","url(UI/Common/images/PortletImages/Icons/wedge-up.gif) center left no-repeat"),t(n.showHideLabel).text("Hide"))}}n.initAutoComplete=function(){t("#"+n.textBox).autocomplete({source:function(n,i){t.ajax({url:urlUtil.getAppRoot()+r(),dataType:"json",success:function(n){u(n,i)}})},minLength:2,width:150,select:n.autoCompleteSelect,appendTo:".searchAutoComplete"});o();f()};n.searchClick=function(){var t=document.getElementById(n.textBox).value;return t==="Search..."||t===""?!1:!0};n.validate=function(){return(console.log("validate"),document.getElementById(n.textBox).value===""||document.getElementById(n.textBox).value==="Search...")?(document.getElementById(n.textBox).focus(),!1):(console.log("valid"),!0)};n.cleardefault=function(){return document.getElementById(n.textBox).value==="Search..."?(document.getElementById(n.textBox).value="",document.getElementById(n.textBox).style.color="#000000",!1):!0};n.restoredefault=function(){return document.getElementById(n.textBox).value===""?(document.getElementById(n.textBox).value="Search...",document.getElementById(n.textBox).style.color="#808080",!1):!0}}(window.searchBox=window.searchBox||{},jQuery),function(n){function r(t){var i=t||window.event,e=[].slice.call(arguments,1),r=0,f=0,u=0;return t=n.event.fix(i),t.type="mousewheel",i.wheelDelta&&(r=i.wheelDelta/120),i.detail&&(r=-i.detail/3),u=r,i.axis!==undefined&&i.axis===i.HORIZONTAL_AXIS&&(u=0,f=-1*r),i.wheelDeltaY!==undefined&&(u=i.wheelDeltaY/120),i.wheelDeltaX!==undefined&&(f=i.wheelDeltaX/-120),e.unshift(t,r,f,u),(n.event.dispatch||n.event.handle).apply(this,e)}var t=["DOMMouseScroll","mousewheel"],i;if(n.event.fixHooks)for(i=t.length;i;)n.event.fixHooks[t[--i]]=n.event.mouseHooks;n.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var n=t.length;n;)this.addEventListener(t[--n],r,!1);else this.onmousewheel=r},teardown:function(){if(this.removeEventListener)for(var n=t.length;n;)this.removeEventListener(t[--n],r,!1);else this.onmousewheel=null}};n.fn.extend({mousewheel:function(n){return n?this.bind("mousewheel",n):this.trigger("mousewheel")},unmousewheel:function(n){return this.unbind("mousewheel",n)}})}(jQuery)